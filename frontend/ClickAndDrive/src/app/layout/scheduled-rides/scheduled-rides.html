<div class="scheduled-rides">
  <div class="content-wrapper">
    
    <!-- Higher section: Title and Filters -->
    <div class="header-section">
      <h1 class="scheduled-rides-title">Scheduled Rides</h1>
      <div class="filters">
        <div class="search-container">
          <span class="search-icon">üîç</span>
          <input type="text" placeholder="Search" class="figma-input">
        </div>
        <div class="sort-container">
          <label>Sort by : </label>
          <select class="figma-select">
            <option>Newest</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Table -->
    <div class="table-container">
      <table class="figma-table">
        <thead>
          <tr>
            <th>Origin</th>
            <th>Destination</th>
            <th>Time</th>
            <th></th>
            <th>Begin</th>
            <th>Cancel</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let ride of rides">
            <td>{{ ride.origin }}</td>
            <td>{{ ride.destination }}</td>
            <td>{{ ride.scheduledTime | date:'shortTime' }}</td>
            <td></td>
            <td>
              <button class="btn-begin" (click)="onStartClick()">Begin ride</button>
            </td>
            <td>
              <button class="btn-cancel" (click)="openPopup(ride.id); selectedRide = ride;">Cancel ride</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="pagination-footer">
      <p class="data-info">Showing data 1 to 6 rides</p>
      <div class="pagination-controls">
        <button (click)="prevPage()">&lt;</button>
        <span>{{ page }}</span>
        <button (click)="nextPage()">&gt;</button>
      </div>
    </div>

  </div>
</div>

<!-- Overlay -->
<div class="overlay" [class.open]="ridePopup.isOpen()" (click)="ridePopup.close()"></div>

<!-- Cancel popup -->
@if (ridePopup.isOpen()) {
  <form class="popup" [class.open]="ridePopup.isOpen()" (click)="$event.stopPropagation()">
    <p>Cancel ride</p>

    <div class="form-group">
      <label for="reason">Reason: </label>
      <textarea [(ngModel)]="cancelReason" name="reason"></textarea>
    </div>
    
    <button
      type="button"
      class="btn-cancel-popup"
      [disabled]="!selectedRide"
      (click)="cancelRide(selectedRide!)">
      Confirm
    </button>
  </form>
}